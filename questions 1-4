Beers = read.csv(file.choose(),header = TRUE)
Breweries = read.csv(file.choose(),header = TRUE)

library(readr)
Breweries <- read_csv("D:/Users/Ryan/SMU classwork/MSDS_6306/breweries.csv")
View(Breweries)
table(Breweries$State)

install.packages("dplyr")
library(dplyr)
install.packages("ggplot2")
library(ggplot2)
install.packages("stringr")
library(stringr)

Breweries = as.data.frame(Breweries)
Breweries.in.each.state = Breweries %>% count(State)

Breweries.in.each.state$State <- str_replace_all(string=Breweries.in.each.state$State, pattern=" ", repl="")
names(Breweries.in.each.state)[1] <- "state"

install.packages("usmap")
library(usmap)

centroid_labels <- utils::read.csv(system.file("extdata", paste0("us_", "states", "_centroids.csv"), package = "usmap"), stringsAsFactors = FALSE)

labels <- merge(x = centroid_labels, y = Breweries.in.each.state, by.x = "abbr", by.y = "state", all.x=TRUE)
names(labels)[6] <- "breweries_count"

plot_usmap(data = Breweries.in.each.state, values = "n", labels=FALSE) + scale_fill_continuous( low = "white", high = "orange", name = "# of Breweries", label = scales::comma) + theme(legend.position = "right") + theme(panel.background = element_rect(colour = "black")) + labs(title = "Number of Breweries by State") + geom_text(data = labels, ggplot2::aes(x = x, y = y, label = scales::number(breweries_count,accuracy = 1)), color = "black")

plot_usmap(include = .northeast_region)


###2.Merge beer data with the breweries data###

library(readr)
Beers <- read_csv("D:/Users/Ryan/SMU classwork/MSDS_6306/beers.csv")
View(Beers)

"Brew_ID" -> colnames(Beers)[colnames(Beers)=="Brewery_id"] 
"Beer_Name" -> colnames(Beers)[colnames(Beers)=="Name"]
"Brewery_Name" -> colnames(Breweries)[colnames(Breweries)=="Name"]
beer.data = merge(Breweries, Beers, by = "Brew_ID", all=TRUE)
head(beer.data)

###3.Address the missing values in each column###
library("GGally")
library("tidyverse")
library("ggthemes")
summary(beer.data)

median.beer.data= 
  beer.data %>% 
  filter(!is.na(ABV & IBU)) %>%
###4.Compute the median alcohol content and international bitterness unit for each state###
  group_by(State) %>% 
  summarize(medianABV = median(ABV), medianIBU = median(IBU)) 


median.beer.data %>%
  ggplot(aes(x=reorder(State, medianABV),y=medianABV)) +
  geom_bar(stat="identity",fill="dodgerblue2") +
  xlab("State") +
  ylab("Median Alchohol Content") +
  ggtitle("Median Alchohol Content Per State") +
  coord_flip() +
  theme_gdocs()
  
  
median.beer.data %>%
  ggplot(aes(x=reorder(State, medianIBU),y=medianIBU)) +
  geom_bar(stat="identity",fill="dodgerblue2") +
  xlab("State") +
  ylab("Median International Bitterness Unit") +
  ggtitle("Median International Bitterness Unit Per State") +
  coord_flip() +
  theme_gdocs()



###5.Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?###


